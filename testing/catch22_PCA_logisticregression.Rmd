---
title: "PCA logistic regression"
author: "Valerie Jill Sydnor"
output: html_document
---

```{r setup, include=FALSE}
library(ciftiTools)
library(rgl)
ciftiTools.setOption('wb_path', '/Users/valeriesydnor/Software/workbench/')
rgl::setupKnitr()
library(rmarkdown)
library(stats)
library(glmnet)
```

```{r}
drugcode <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/sub_ses_drugvplacebo.csv", header = TRUE)
```

```{r}
catch22.logistic.regression <- function(catchnum){
  pca.scores <- read.csv(sprintf("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch%s.PCA.scores.csv", catchnum))
  pca.scores <- merge(pca.scores, drugcode, by = "sesid")
  
logreg.catch <- glm(as.factor(pca.scores$drug) ~ pca.scores$PC1 + pca.scores$PC2 + pca.scores$meanFD, family=binomial(logit)) 
summary(logreg.catch)
}
```

DN_HistogramMode_5
```{r}
catch22.logistic.regression(1)
```
DN_HistogramMode_10
```{r}
catch22.logistic.regression(2)
```
CO_f1ecac

CO_FirstMin_ac
```{r}
catch22.logistic.regression(4)
```

CO_HistogramAMI_even_2_5
```{r}
catch22.logistic.regression(5)
```
CO_trev_1_num
```{r}
catch22.logistic.regression(6)
```
MD_hrv_classic_pnn40
```{r}
catch22.logistic.regression(7)
```
SB_BinaryStats_mean_longstretch1
```{r}
catch22.logistic.regression(8)
```
SB_TransitionMatrix_3ac_sumdiagcov
```{r}
catch22.logistic.regression(9)
```
PD_PeriodicityWang_th0_01
```{r}
catch22.logistic.regression(10)
```
CO_Embed2_Dist_tau_d_expfit_meandiff
```{r}
catch22.logistic.regression(11)
```
IN_AutoMutualInfoStats_40_gaussian_fmmi
```{r}
catch22.logistic.regression(12)
```
FC_LocalSimple_mean1_tauresrat
```{r}
catch22.logistic.regression(13)
```
DN_OutlierInclude_p_001_mdrmd
```{r}
catch22.logistic.regression(14)
```
DN_OutlierInclude_n_001_mdrmd
```{r}
catch22.logistic.regression(15)
```

SP_Summaries_welch_rect_area_5_1
```{r}
catch22.logistic.regression(16)
```

SB_BinaryStats_diff_longstretch0
```{r}
catch22.logistic.regression(17)
```
SB_MotifThree_quantile_hh
```{r}
catch22.logistic.regression(18)
```
SC_FluctAnal_2_rsrangefit_50_1_logi_prop_r1
```{r}
catch22.logistic.regression(19)
```
SC_FluctAnal_2_dfa_50_1_2_logi_prop_r1
```{r}
catch22.logistic.regression(20)
```
SP_Summaries_welch_rect_centroid
```{r}
catch22.logistic.regression(21)
```
FC_LocalSimple_mean3_stderr
```{r}
catch22.logistic.regression(22)
```

```{r}
pca.scores.1 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch1.PCA.scores.csv", header= TRUE)
pca.scores.2 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch2.PCA.scores.csv", header= TRUE)
#pca.scores.3 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch3.PCA.scores.csv", header= TRUE)
pca.scores.4 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch4.PCA.scores.csv", header= TRUE)
pca.scores.5 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch5.PCA.scores.csv", header= TRUE)
pca.scores.6 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch6.PCA.scores.csv", header= TRUE)
pca.scores.7 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch7.PCA.scores.csv", header= TRUE)
pca.scores.8 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch8.PCA.scores.csv", header= TRUE)
pca.scores.9 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch9.PCA.scores.csv", header= TRUE)
pca.scores.10 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch10.PCA.scores.csv", header= TRUE)
pca.scores.11 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch11.PCA.scores.csv", header= TRUE)
pca.scores.12 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch12.PCA.scores.csv", header= TRUE)
pca.scores.13 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch13.PCA.scores.csv", header= TRUE)
pca.scores.14 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch14.PCA.scores.csv", header= TRUE)
pca.scores.15 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch15.PCA.scores.csv", header= TRUE)
pca.scores.16 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch16.PCA.scores.csv", header= TRUE)
pca.scores.17 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch17.PCA.scores.csv", header= TRUE)
pca.scores.18 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch18.PCA.scores.csv", header= TRUE)
pca.scores.19 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch19.PCA.scores.csv", header= TRUE)
pca.scores.20 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch20.PCA.scores.csv", header= TRUE)
pca.scores.21 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch21.PCA.scores.csv", header= TRUE)
pca.scores.22 <- read.csv("/cbica/projects/spatiotemp_dev_plasticity/Inhibition/Alpraz/catch22/pca/scores/catch22.PCA.scores.csv", header= TRUE)
```

Regression with all PC1s
```{r}
PC1.data <- merge

logistic.regression.PC1s <- glm(as.factor(drugcode$drug) ~ pca.scores.1$PC1 + pca.scores.2$PC1 + pca.scores.4$PC1 + pca.scores.5$PC1 + pca.scores.6$PC1 + pca.scores.7$PC1 + pca.scores.8$PC1 + pca.scores.9$PC1 + pca.scores.10$PC1 + pca.scores.11$PC1 + pca.scores.12$PC1 + pca.scores.13$PC1 + pca.scores.14$PC1 + pca.scores.15$PC1 + pca.scores.16$PC1 + pca.scores.17$PC1 + pca.scores.18$PC1 + pca.scores.19$PC1 + pca.scores.20$PC1 + pca.scores.21$PC1 + pca.scores.22$PC1 + drugcode$meanFD, family=binomial(logit)) 
summary(logistic.regression.PC1s)
```

